{% extends 'html/base.html' %}
{% load static %}
{% load widget_tweaks %}
{% block content %}

<form id="reset-form">
  <p></p>
  <button class="btn btn-primary" type="submit" >Сбросить фильтры</button>
</form>

<form method="get">
  <p></p>
  <button class="btn btn-primary" type="submit">Поиск</button>


  <table class="table table-striped table-hover table-bordered mt-3">
  <thead>
    <tr>
      <th>№</th>
      <th>Дата</th>
      <th>Время</th>
      {% if entity == 'legal' %}
        <th>{{ OurFilter.form.legal_entity__company_name }} ТОО</th>
        <th>{{ OurFilter.form.legal_entity__bin }} БИН</th>
      {% else %}
        <th>{{ OurFilter.form.individual_entity__last_name }} Фамилия</th>
        <th>{{ OurFilter.form.individual_entity__first_name }} Имя</th>
        <th>{{ OurFilter.form.individual_entity__patronymic_name }} Отчество</th>
        <th>{{ OurFilter.form.individual_entity__iin }} ИИН</th>
      {% endif %}
      <th>{{ OurFilter.form.phone_number }} Телефон</th>
      <th>{{ OurFilter.form.object_category }} Категория</th>
      <th>{{ OurFilter.form.task }} Задание</th>
      <th>{{ OurFilter.form.city }}Город</th>
      <th>{{ OurFilter.form.district }} Район</th>
      <th>{{ OurFilter.form.street }} Улица</th>
      <th>{{ OurFilter.form.bldg }} Дом</th>
      <th>{{ OurFilter.form.block }} Блок</th>
      <th>{{ OurFilter.form.entrance }} Подъезд</th>
      <th>{{ OurFilter.form.floor }} Этаж</th>
      {% if entity == 'legal' %}
        <th>{{ OurFilter.form.apt_num }} Офис</th>
      {% else %}
        <th>{{ OurFilter.form.apt_num }} Квартира</th>
      {% endif %}
      <th>Площадь</th>
      <th>Точка подключения</th>
      <th>Мощность</th>
      <th>Номинал автомата</th>
      <th>Головной ПУ</th>
      <th>Тип счетчика</th>
      <th>Номер счетчика</th>
      <th>Дата договора</th>
      <th>Энергосберегающая организация</th>
      <th>{{ OurFilter.form.operator }} Оператор</th>
      <th>Статус</th>
    </tr>
  </thead>
  <tbody>

  {% for bid in cards %}
    <tr>
      <td>&nbsp;<span style="color:black; font-weight: bold"><a href="{% url 'card_detail' cid=bid.id %}">{{ bid.id }}</a></span></td>
      <td>{{ bid.created_at | date:"d.m.y" }}</td>
      <td>{{ bid.created_at | date:"H:i" }}</td>
      {% if entity == 'legal' %}
        <td>{{ bid.legal_entity.company_name }}</td>
        <td>{{ bid.legal_entity.bin }}</td>
      {% else %}
        <td>{{ bid.individual_entity.last_name }}</td>
        <td>{{ bid.individual_entity.first_name }}</td>
        <td>{{ bid.individual_entity.patronymic_name }}</td>
        <td>{{ bid.individual_entity.iin }}</td>
      {% endif %}
      <td>{{ bid.phone_number }}</td>
      <td>{{ bid.object_category }}</td>
      <td>{{ bid.task }}</td>
      <td>{{ bid.city }}</td>
      <td>{{ bid.district }}</td>
      <td>{{ bid.street }}</td>
      <td>{{ bid.bldg }}</td>
      <td>{{ bid.block }}</td>
      <td>{{ bid.entrance }}</td>
      <td>{{ bid.floor }}</td>
      <td>{{ bid.apt_num }}</td>
      <td>{{ bid.square }}</td>
      <td>{{ bid.connection_point }}</td>
      <td>{{ bid.power }}</td>
      <td>{{ bid.nominal }}</td>
      <td>{{ bid.main_point }}</td>
      <td>{{ bid.counter_model }}</td>
      <td>{{ bid.counter_number }}</td>
      <td>{{ bid.contract }}</td>
      <td>{{ bid.organization }}</td>
      <td>{{ bid.operator }}</td>
      <td>На рассмотрении</td>
    </tr>
  {% endfor %}

  </tbody>
  </table>
</form>


<script>
  $('#reset-form').submit(function(event) {
    event.preventDefault();
    window.location.href = '{% url "card_list" entity=entity %}';
  });
</script>

{% endblock content %}